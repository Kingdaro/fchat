<template>
  <main class="flex-column">
    <section class="scroll-v" style="height: 5rem; padding: 0.3rem 0.6rem">
      <character-name v-bind="character"></character-name>
      <span v-if="character.statusMessage" v-html="' - ' + parseBBC(character.statusMessage)"></span>
    </section>
    <section class="flex-grow bg-color-darken-1 scroll-v">
      <message v-for="(message, i) in messages" v-bind="message" :key="i"></message>
    </section>
    <section class="bg-color-main flex-row" style="height: 5rem; padding: 0.3rem;">
      <chatbox class="flex-grow" @submit="sendMessage"></chatbox>
    </section>
  </main>
</template>

<script>
import { parseBBC } from '../../bbc'

export default {
  components: {
    CharacterName: require('./CharacterName.vue'),
    Message: require('./Message.vue'),
    Chatbox: require('./Chatbox.vue'),
  },
  props: {
    partner: String,
    messages: Array,
  },
  methods: {
    parseBBC,
    sendMessage(message) {
      this.$store.dispatch('sendPrivateMessage', { recipient: this.partner, message })
    },
  },
  computed: {
    character() {
      return this.$store.getters.getCharacter(this.partner)
    }
  }
}
</script>
